{% extends "base.html" %}

{% block title %} About the project {% endblock %}

{% block content %}
<div class="docs-page">
    <div class="docs-container">
        <div class="docs-grid">
            <!-- Sidebar Navigation -->
            <aside class="docs-sidebar">
                <nav class="docs-nav">
                    <div class="docs-nav-heading">Contents</div>
                    <a class="docs-nav-link" href="#overview">Overview</a>
                    <a class="docs-nav-link" href="#methodology">Methodology</a>
                    <a class="docs-nav-link indent" href="#hydraulic-validation">Hydraulic Validation</a>
                    <a class="docs-nav-link indent" href="#neural-networks">Neural Networks</a>
                    <a class="docs-nav-link indent" href="#recommendations">Recommendations</a>
                    <a class="docs-nav-link" href="#performance">Performance</a>
                    <a class="docs-nav-link" href="#standards">Standards</a>
                    <a class="docs-nav-link" href="#technology">Technology</a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="docs-content">
                <header class="docs-header">
                    <h1>Stormwater Analysis System</h1>
                    <p class="docs-lead">
                        An integrated platform for hydraulic modeling and machine learning-based
                        classification of storm sewer networks.
                    </p>
                </header>

                <!-- Overview -->
                <section id="overview" class="docs-section">
                    <h2>Overview</h2>
                    <p>
                        This system processes SWMM (Storm Water Management Model) files through a pipeline
                        that validates hydraulic parameters, classifies catchments using neural networks,
                        and generates engineering recommendations based on Polish technical standards.
                    </p>
                    <p>
                        The methodology integrates hydraulic engineering principles with machine learning
                        to provide automated assessment and optimization recommendations for storm sewer
                        network design.
                    </p>
                </section>

                <!-- Methodology -->
                <section id="methodology" class="docs-section">
                    <h2>Scientific Methodology</h2>

                    <h3 id="hydraulic-validation">1. Hydraulic Model Validation</h3>
                    <p>
                        The validation process examines hydraulic models for gravity sewer systems,
                        verifying compliance with Polish and European standards.
                    </p>

                    <h4>Key Parameters</h4>
                    <ul>
                        <li><strong>Flow velocity:</strong> 0.7 - 5.0 m/s (PN-EN 752:2008)</li>
                        <li><strong>Maximum burial depth:</strong> 6 m (WTP 1964)</li>
                        <li><strong>Pipe filling:</strong> max 82.7% for optimal efficiency</li>
                        <li><strong>Minimum cover:</strong> based on frost zone classification</li>
                    </ul>

                    <h4>Frost Zone Classification (PN-81/B-03020)</h4>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <thead>
                                <tr>
                                    <th>Zone</th>
                                    <th>Frost Depth (m)</th>
                                    <th>Min Cover (m)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>I</td><td>0.8</td><td>1.0</td></tr>
                                <tr><td>II</td><td>1.0</td><td>1.2</td></tr>
                                <tr><td>III</td><td>1.2</td><td>1.4</td></tr>
                                <tr><td>IV</td><td>1.4</td><td>1.6</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 id="neural-networks">2. Neural Network Classification</h3>
                    <p>
                        Catchment classification employs a feed-forward neural network to categorize
                        areas based on physical and hydrological characteristics.
                    </p>

                    <h4>Network Architecture</h4>
                    <ul>
                        <li><strong>Input layer:</strong> 12 neurons (hydrological features)</li>
                        <li><strong>Hidden layer 1:</strong> 32 neurons, ReLU activation, dropout 0.3</li>
                        <li><strong>Hidden layer 2:</strong> 16 neurons, ReLU activation, dropout 0.2</li>
                        <li><strong>Output layer:</strong> 14 neurons, softmax (catchment classes)</li>
                    </ul>

                    <h4>Catchment Categories</h4>
                    <p>The system recognizes 14 distinct catchment types:</p>
                    <div class="docs-list-compact">
                        Permeable Areas, Permeable Plains, Vegetated Mountains, Rocky Mountains,
                        Low/Medium/High-Density Urban, Low/High-Density Suburban, Rural Areas,
                        Forests, Meadows, Agricultural Land, Wetlands
                    </div>

                    <h4>Rainfall Scenarios</h4>
                    <p>Training data incorporates 22 rainfall scenarios:</p>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <thead>
                                <tr>
                                    <th>Distribution</th>
                                    <th>Characteristics</th>
                                    <th>Duration</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Euler Type II</td>
                                    <td>Asymmetric, peak at 30% duration (ATV A-118:2006)</td>
                                    <td>60-240 min</td>
                                </tr>
                                <tr>
                                    <td>Chicago</td>
                                    <td>Symmetric, peak at 50% duration</td>
                                    <td>60-120 min</td>
                                </tr>
                                <tr>
                                    <td>Uniform</td>
                                    <td>Constant intensity (Blaszczyk formula)</td>
                                    <td>15-30 min</td>
                                </tr>
                                <tr>
                                    <td>PANDa Atlas</td>
                                    <td>IMGW-PIB probabilistic data for Wroclaw</td>
                                    <td>5-240 min</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 id="recommendations">3. Recommendation System</h3>
                    <p>
                        The recommendation module analyzes validated parameters to generate engineering
                        solutions through a neural network trained on 5,940 conduit samples.
                    </p>

                    <h4>Recommendation Classes</h4>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <thead>
                                <tr>
                                    <th>Class</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>pump</td><td>Install pumping station</td></tr>
                                <tr><td>tank</td><td>Install retention tank</td></tr>
                                <tr><td>seepage boxes</td><td>Install infiltration boxes</td></tr>
                                <tr><td>diameter increase</td><td>Increase pipe diameter</td></tr>
                                <tr><td>diameter reduction</td><td>Reduce pipe diameter</td></tr>
                                <tr><td>slope increase</td><td>Increase longitudinal slope</td></tr>
                                <tr><td>slope reduction</td><td>Decrease longitudinal slope</td></tr>
                                <tr><td>depth increase</td><td>Increase pipe depth</td></tr>
                                <tr><td>valid</td><td>No modifications required</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Performance -->
                <section id="performance" class="docs-section">
                    <h2>Model Performance</h2>

                    <h3>Catchment Classifier</h3>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <tbody>
                                <tr><td>Test accuracy</td><td><strong>98.28%</strong></td></tr>
                                <tr><td>Training method</td><td>3-fold cross-validation</td></tr>
                                <tr><td>Epochs</td><td>222 (early stopping)</td></tr>
                                <tr><td>Hyperparameter search</td><td>36 combinations</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Recommendation Model</h3>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <tbody>
                                <tr><td>Test accuracy</td><td><strong>99.8%</strong></td></tr>
                                <tr><td>Macro-F1 score</td><td>0.995</td></tr>
                                <tr><td>Training samples</td><td>5,940</td></tr>
                                <tr><td>Regularization</td><td>L2 (1×10⁻⁴) + Dropout (0.15)</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>Algorithm Comparison</h3>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <thead>
                                <tr>
                                    <th>Algorithm</th>
                                    <th>Accuracy</th>
                                    <th>Macro-F1</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>Neural Network</td><td>99.93%</td><td>0.873</td></tr>
                                <tr><td>XGBoost</td><td>99.93%</td><td>0.875</td></tr>
                                <tr><td>Random Forest</td><td>99.79%</td><td>0.872</td></tr>
                                <tr><td>SVM</td><td>98.32%</td><td>0.856</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Standards -->
                <section id="standards" class="docs-section">
                    <h2>Standards & Compliance</h2>
                    <ul>
                        <li><strong>PN-EN 752:2008</strong> — European standard for drain and sewer systems</li>
                        <li><strong>PN-81/B-03020</strong> — Polish frost zone classification</li>
                        <li><strong>WPT 1964/1965</strong> — Municipal sewer design guidelines</li>
                        <li><strong>ATV A-118:2006</strong> — German rainfall distribution standards</li>
                    </ul>
                </section>

                <!-- Technology -->
                <section id="technology" class="docs-section">
                    <h2>Technology Stack</h2>
                    <div class="docs-table-wrapper">
                        <table class="docs-table">
                            <tbody>
                                <tr>
                                    <td><strong>Core Processing</strong></td>
                                    <td>PySWMM 1.2.0, swmmio 0.6.7, Python 3.11</td>
                                </tr>
                                <tr>
                                    <td><strong>Machine Learning</strong></td>
                                    <td>TensorFlow, Keras, Scikit-learn</td>
                                </tr>
                                <tr>
                                    <td><strong>Data Processing</strong></td>
                                    <td>Pandas, NumPy, PostgreSQL</td>
                                </tr>
                                <tr>
                                    <td><strong>Web Framework</strong></td>
                                    <td>Django, Bootstrap 5, SVG.js</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </main>
        </div>
    </div>
</div>

<style>
/* Documentation Page - Clean Academic Style */
.docs-page {
    min-height: 100vh;
    background: white;
}

.docs-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--space-6) var(--space-8);
}

.docs-grid {
    display: grid;
    grid-template-columns: 220px 1fr;
    gap: var(--space-10);
}

/* Sidebar */
.docs-sidebar {
    position: sticky;
    top: 90px;
    height: fit-content;
}

.docs-nav {
    border-left: 1px solid var(--slate-200);
    padding-left: var(--space-4);
}

.docs-nav-heading {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--slate-500);
    margin-bottom: var(--space-3);
}

.docs-nav-link {
    display: block;
    padding: var(--space-1) 0;
    color: var(--slate-600);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color var(--transition-fast);
}

.docs-nav-link:hover {
    color: var(--primary-600);
}

.docs-nav-link.active {
    color: var(--primary-700);
    font-weight: 500;
}

.docs-nav-link.indent {
    padding-left: var(--space-4);
    font-size: 0.85rem;
    color: var(--slate-500);
}

/* Main Content */
.docs-content {
    min-width: 0;
    max-width: 800px;
}

.docs-header {
    margin-bottom: var(--space-10);
    padding-bottom: var(--space-6);
    border-bottom: 1px solid var(--slate-200);
}

.docs-header h1 {
    font-size: 2rem;
    font-weight: 700;
    color: var(--slate-900);
    margin-bottom: var(--space-3);
}

.docs-lead {
    font-size: 1.1rem;
    color: var(--slate-600);
    line-height: var(--line-height-relaxed);
    margin: 0;
}

/* Sections */
.docs-section {
    margin-bottom: var(--space-10);
}

.docs-section h2 {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--slate-900);
    margin-bottom: var(--space-4);
    padding-bottom: var(--space-2);
    border-bottom: 1px solid var(--slate-200);
    scroll-margin-top: 100px;
}

.docs-section h3 {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--slate-800);
    margin-top: var(--space-8);
    margin-bottom: var(--space-3);
    scroll-margin-top: 100px;
}

.docs-section h4 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--slate-700);
    margin-top: var(--space-5);
    margin-bottom: var(--space-2);
}

.docs-section p {
    color: var(--slate-600);
    line-height: var(--line-height-relaxed);
    margin-bottom: var(--space-4);
}

.docs-section ul {
    margin: var(--space-3) 0 var(--space-5);
    padding-left: var(--space-6);
    color: var(--slate-600);
}

.docs-section li {
    margin-bottom: var(--space-2);
    line-height: var(--line-height-relaxed);
}

.docs-section strong {
    color: var(--slate-700);
    font-weight: 600;
}

/* Compact list */
.docs-list-compact {
    background: var(--slate-50);
    padding: var(--space-3) var(--space-4);
    border-radius: var(--radius-md);
    color: var(--slate-600);
    font-size: 0.9rem;
    line-height: var(--line-height-relaxed);
    margin: var(--space-3) 0 var(--space-5);
}

/* Tables */
.docs-table-wrapper {
    margin: var(--space-4) 0 var(--space-6);
    overflow-x: auto;
}

.docs-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
}

.docs-table th {
    text-align: left;
    padding: var(--space-3) var(--space-4);
    background: var(--slate-50);
    color: var(--slate-700);
    font-weight: 600;
    border-bottom: 2px solid var(--slate-200);
}

.docs-table td {
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--slate-100);
    color: var(--slate-600);
}

.docs-table tbody tr:hover {
    background: var(--slate-50);
}

.docs-table td strong {
    color: var(--slate-800);
}

/* Responsive */
@media (max-width: 900px) {
    .docs-grid {
        grid-template-columns: 1fr;
    }

    .docs-sidebar {
        position: relative;
        top: 0;
        margin-bottom: var(--space-6);
    }

    .docs-nav {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
        border-left: none;
        padding-left: 0;
        border-bottom: 1px solid var(--slate-200);
        padding-bottom: var(--space-3);
    }

    .docs-nav-heading {
        width: 100%;
    }

    .docs-nav-link {
        padding: var(--space-1) var(--space-3);
        background: var(--slate-100);
        border-radius: var(--radius-md);
    }

    .docs-nav-link.indent {
        display: none;
    }

    .docs-container {
        padding: var(--space-4);
    }

    .docs-header h1 {
        font-size: 1.75rem;
    }
}

@media print {
    .docs-sidebar {
        display: none;
    }

    .docs-container {
        max-width: 100%;
        padding: 0;
    }

    .docs-grid {
        display: block;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Smooth scroll
    document.querySelectorAll('.docs-nav-link').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href.startsWith('#')) {
                e.preventDefault();
                const target = document.querySelector(href);
                if (target) {
                    window.scrollTo({
                        top: target.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            }
        });
    });

    // Active section highlighting
    const sections = document.querySelectorAll('.docs-section h2[id], .docs-section h3[id]');
    const navLinks = document.querySelectorAll('.docs-nav-link');

    function updateActive() {
        const scrollPos = window.pageYOffset + 120;
        let current = '';

        sections.forEach(section => {
            if (scrollPos >= section.offsetTop) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    }

    window.addEventListener('scroll', updateActive);
    updateActive();
});
</script>

{% endblock %}
